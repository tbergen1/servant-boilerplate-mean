<div id="plan-page" data-ng-controller="PlanController">

    <p id="menu-bar" class="st-font">
        <a data-ui-sref="servants">
            Servants
        </a>
        <a data-ui-sref="menu({ servantID: s.user.servants[servant_index].servant_id })">
            Menu
        </a>
        <a data-ui-sref="number({ servantID: s.user.servants[servant_index].servant_id })">
            Number
        </a>
        <a class="active">
            Plan
        </a>
        <a href="/logout">
            Logout
        </a>
    </p>

    <div class="page-container st-animate-zoom-in">
        <i class="fa fa-question-circle help-icon st-red st-animate-blink" data-ng-click="help = !help"></i>

        <div data-ng-show="subscribed && !help">
            <h3 class="st-font st-centered">
                Congratulations!
            </h3>
            <p class="st-font st-centered" style="margin-top:30px;">
                Your Subscription Was Successfully Created!
            </p>
            <p class="st-font st-centered st-animate-blink" style="margin-top:30px;">
                Redirecting You...
            </p>
        </div>
        <div data-ng-show="!subscribed && !help">
            <p class="st-centered">
                <img class="servant-image st-animate-bounce-in" data-ng-src="https://d2d0226i04jal.cloudfront.net/images/servants/{{ s.user.servants[servant_index].personality.toLowerCase() }}.svg">
            </p>
            <p class="st-centered st-font st-red">{{s.user.servants[servant_index].master}} </p>

            <p class="st-font st-centered" data-ng-show="s.user.servants[servant_index].servant_pay.subscription_status === 'none'">
                This Servant does not have a subscription
            </p>
            <p class="st-font st-centered" data-ng-show="s.user.servants[servant_index].servant_pay.subscription_status === 'active'">
                Below is this Servant's subscription
            </p>

            <hr style="margin: 20px auto 20px auto;width:75%">

            <p class="st-font st-centered" data-ng-show="s.user.servants[servant_index].servant_pay.subscription_status === 'none'">
                How Many Text Messages Do You Need Each Month?
            </p>

            <p class="st-centered" style="margin-top:20px;">
                <select class="form-control input-lg plan-select" data-ng-model="newPlan" data-ng-options="plan.plan_id as plan.label for plan in plans">
                </select>
            </p>

            <!-- Plan Features -->
            <ul class="list-unstyled plan-features st-font">
                <li>
                    <i class="fa fa-chevron-right"></i> Includes 1 dedicated phone number
                </li>
                <li>
                    <i class="fa fa-chevron-right"></i> Change/Cancel Plan at any time
                </li>
                <li>
                    <i class="fa fa-chevron-right"></i> No additional fees
                </li>
            </ul>

            <hr style="margin: 25px auto 20px auto;width:75%">

            <p class="st-font st-centered" style="margin-top:30px;" data-ng-hide="newPlan === s.user.servants[servant_index].servant_pay.subscription_plan_id">
                Subscribe To
                <span data-ng-show="newPlan === 'test'">500</span>
                <span data-ng-show="newPlan === 'plan1'">500</span>
                <span data-ng-show="newPlan === 'plan2'">1000</span>
                <span data-ng-show="newPlan === 'plan3'">1500</span>
                <span data-ng-show="newPlan === 'plan4'">2000</span>
                <span data-ng-show="newPlan === 'plan5'">2500</span> Texts For
                <span data-ng-show="newPlan === 'test'">test</span>
                <span data-ng-show="newPlan === 'plan1'">$12/Month?</span>
                <span data-ng-show="newPlan === 'plan2'">$24/Month?</span>
                <span data-ng-show="newPlan === 'plan3'">$36/Month?</span>
                <span data-ng-show="newPlan === 'plan4'">$48/Month?</span>
                <span data-ng-show="newPlan === 'plan5'">$60/Month?</span>
            </p>

            <p class="st-red st-font st-centered" data-ng-show="error">{{ error }}</p>

            <p class="st-font st-centered" style="margin-top:20px;">
                <button class="st-btn-red st-btn-lg" data-ng-hide="subscribing || s.user.servants[servant_index].servant_pay.subscription_status === 'active'" data-ng-click="subscribe()">Subscribe</button>

                <span class="st-centered st-font st-red" data-ng-show="newPlan === s.user.servants[servant_index].servant_pay.subscription_plan_id">Select A New Plan To Change Your Subscription</span>

                <button class="st-btn-red st-btn-lg st-animate-bounce-in" data-ng-hide="subscribing || s.user.servants[servant_index].servant_pay.subscription_status === 'none' || newPlan === s.user.servants[servant_index].servant_pay.subscription_plan_id" data-ng-click="subscribe()">Change Plan</button>

                <button class="st-btn-red st-btn-lg disabled" data-ng-show="subscribing">
                    <i class="fa fa-refresh fa-spin"></i> Subscribing
                </button>
            </p>

            <p class="st-font st-centered" data-ng-hide="newPlan === s.user.servants[servant_index].servant_pay.subscription_plan_id" style="opacity:0.7;font-size:10px;margin:20px auto 0px auto;width:75%;">
                Clicking Subscribe will automatically charge the card you have on file with Servant
            </p>

            <hr style="margin: 25px auto 20px auto;width:75%">

            <p class="st-font st-centered" style="margin:30px auto;max-width:300px;" data-ng-show="s.user.servants[servant_index].servant_pay.subscription_status === 'active'">
                Warning: Canceling your plan means you lose your phone number and you will never be able to retrieve it. Anywhere you have posted the phone number publicly will lead people to an incorrect phone number...
            </p>

            <p class="st-centered st-font st-link" style="margin-top:20px;" data-ng-show="s.user.servants[servant_index].servant_pay.subscription_status === 'active' && !canceling" data-ng-click="cancelPlan()">
                Cancel Your Plan
            </p>

            <p class="st-centered st-font st-link" style="margin-top:30px;" data-ng-show="canceling">
                Canceling...
            </p>
        </div>


        <!-- Help View -->
        <div class="help-area" data-ng-show="help">
            <h5 class="st-font st-red st-centered">Help Area</h5>
            <p class="st-font st-centered">"Subscriptions"</p>
            <hr style="margin: 20px auto 20px auto;width:95%">

            <table class="table">
                <tr>
                    <td>
                        <i class="fa fa-chevron-right"></i>
                    </td>
                    <td class="st-font">
                        Each Servant has its own subscription with Servant Texter.
                    </td>
                </tr>
                <tr>
                    <td>
                        <i class="fa fa-chevron-right"></i>
                    </td>
                    <td class="st-font">
                        Subscriptions are paid for using "Servant Pay" which charges the card you currently have on file with Servant.  This way you don't need to enter in your credit card information again, and you will have the ability to easily cancel your subscription for this application in the main Servant dashboard.
                    </td>
                </tr>
                <tr>
                    <td>
                        <i class="fa fa-chevron-right"></i>
                    </td>
                    <td class="st-font">
                        There are no fees for starting or stopping your subscription.  You can stop or change your subscription plan at any time.
                    </td>
                </tr>
                <tr>
                    <td>
                        <i class="fa fa-chevron-right"></i>
                    </td>
                    <td class="st-font">
                        Subscriptions are required because renting phone numbers and sending text messages costs money.
                    </td>
                </tr>
                <tr>
                    <td>
                        <i class="fa fa-chevron-right"></i>
                    </td>
                    <td class="st-font" colspan="2">
                        Get further help in the <a href="https://www.hipchat.com/grXCavfpe" target="_blank">Servant Chat Room</a>
                    </td>
                </tr>
            </table>
        </div>
        <!-- Help Screen -->

    </div>
</div>